<app-notification 
  [notifications]="notifications()"
  [showMultiple]="showMultipleNotifications()"
  [mostSevereNotification]="getMostSevereNotification()">
</app-notification>

<app-particles-bg></app-particles-bg>
<main class="layout bg-primary">

  <!-- ASIDE -->
  <aside class="layout__aside surface bg-card border-primary">
    <app-aside></app-aside>
  </aside>

  <!-- CONTENUTO -->
  <section class="dashboard">
    <div class="dashboard__card">
      <!-- Login button (in alto a destra), stile simile al toggle tema dell'aside -->
      <button
        class="btn btn-sm dashboard__login"
        (click)="onAuthButtonClick()"
        [title]="isAuthed() ? 'Logout' : 'Accedi'"
        [attr.aria-label]="isAuthed() ? 'Logout' : 'Accedi'">
        <span class="dashboard__login-label">{{ isAuthed() ? 'Logout' : 'Accedi' }}</span>
      </button>
      <div class="dashboard__nav">
        <app-navbar class="floating-nav floating-nav--inline"></app-navbar>
      </div>

      <app-dashboard class="dashboard__content"></app-dashboard>
    </div>
  </section>
</main>

@if (isLoginOpen()) {
  <div class="mf-modal-backdrop"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Accedi">
    <div class="mf-modal__content">
      <button class="mf-modal__close" (click)="closeLogin()" aria-label="Chiudi">Ã—</button>
      <app-auth #authComponent class="card"></app-auth>
    </div>
  </div>
}

@if (isCvUploadModalOpen()) {
  <div class="mf-modal-backdrop" (click)="onCvUploadCancelled()"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Carica Curriculum" (click)="onCvUploadCancelled()">
    <div class="mf-modal__content" (click)="$event.stopPropagation()" style="width: auto; max-width: 500px;">
      <app-cv-upload-modal
        (uploaded)="onCvUploaded()"
        (cancelled)="onCvUploadCancelled()">
      </app-cv-upload-modal>
    </div>
  </div>
}

@if (isAddAttestatoModalOpen()) {
  <div class="mf-modal-backdrop"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Aggiungi Attestato">
    <div class="mf-modal__content" (click)="$event.stopPropagation()" style="width: auto; max-width: 600px;">
      <app-add-attestato-modal
        (created)="onAttestatoCreated()"
        (errorOccurred)="onAttestatoError($event)"
        (cancelled)="onAttestatoCancelled()">
      </app-add-attestato-modal>
    </div>
  </div>
}