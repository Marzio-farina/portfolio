<app-notification 
  [notifications]="notifications()"
  [showMultiple]="showMultipleNotifications()"
  [mostSevereNotification]="getMostSevereNotification()">
</app-notification>

<app-particles-bg></app-particles-bg>
<div class="layout bg-primary">

  <!-- Contenitore per aside principale e secondario -->
  <div class="layout__aside-wrapper">
    <!-- ASIDE -->
    <aside class="layout__aside surface bg-card border-primary" aria-label="Informazioni personali">
      <app-aside></app-aside>
    </aside>

    <!-- ASIDE SECONDARIO (visibile solo >= 1250px) -->
    <aside class="layout__aside-secondary" aria-label="Collegamenti social">
      <app-aside-secondary></app-aside-secondary>
    </aside>
  </div>

  <!-- CONTENUTO PRINCIPALE -->
  <main class="dashboard" role="main">
    <div class="dashboard__card">
      <!-- Login button (in alto a destra), stile simile al toggle tema dell'aside -->
      <button
        class="btn btn-sm dashboard__login"
        (click)="onAuthButtonClick()"
        [title]="isAuthed() ? 'Logout' : 'Accedi'"
        [attr.aria-label]="isAuthed() ? 'Logout' : 'Accedi'">
        <span class="dashboard__login-label">{{ isAuthed() ? 'Logout' : 'Accedi' }}</span>
      </button>
      <nav class="dashboard__nav" aria-label="Navigazione principale">
        <app-navbar class="floating-nav floating-nav--inline"></app-navbar>
      </nav>

      <app-dashboard class="dashboard__content"></app-dashboard>
    </div>
  </main>
</div>

@if (isLoginOpen()) {
  <div class="mf-modal-backdrop"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Accedi">
    <div class="mf-modal__content">
      <button class="mf-modal__close" (click)="closeLogin()" aria-label="Chiudi">Ã—</button>
      <app-auth #authComponent class="card"></app-auth>
    </div>
  </div>
}

@if (isCvUploadModalOpen()) {
  <div class="mf-modal-backdrop" (click)="onCvUploadCancelled()"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Carica Curriculum" (click)="onCvUploadCancelled()">
    <div class="mf-modal__content" (click)="$event.stopPropagation()" style="width: auto; max-width: 500px;">
      <app-cv-upload-modal
        (uploaded)="onCvUploaded()"
        (cancelled)="onCvUploadCancelled()">
      </app-cv-upload-modal>
    </div>
  </div>
}

 

@if (isAttestatoDetailModalOpen() && selectedAttestato()) {
  <div class="mf-modal-backdrop" (click)="onAttestatoDetailClosed()"></div>
  <div class="mf-modal mf-modal--attestato" role="dialog" aria-modal="true" aria-label="Dettaglio Attestato" (click)="onAttestatoDetailClosed()">
    <div class="mf-modal__content" (click)="$event.stopPropagation()" style="width: auto; max-width: 800px;">
      <app-attestato-detail-modal
        [attestato]="selectedAttestato()!"
        (closed)="onAttestatoDetailClosed()">
      </app-attestato-detail-modal>
    </div>
  </div>
}

@if (isProjectDetailModalOpen() && selectedProject()) {
  <div class="mf-modal-backdrop"></div>
  <div class="mf-modal mf-modal--project" role="dialog" aria-modal="true" aria-label="Dettaglio Progetto">
    <div class="mf-modal__content" (click)="$event.stopPropagation()">
      <app-project-detail-modal
        [project]="selectedProject()!"
        (closed)="onProjectDetailClosed()">
      </app-project-detail-modal>
    </div>
  </div>
}

@if (isCvPreviewModalOpen()) {
  <div class="mf-modal-backdrop"></div>
  <div class="mf-modal" role="dialog" aria-modal="true" aria-label="Anteprima CV">
    <div class="mf-modal__content" style="width: auto; max-width: 920px;">
      <app-cv-preview-modal></app-cv-preview-modal>
    </div>
  </div>
}