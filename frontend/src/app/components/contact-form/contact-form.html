<section class="contact">
  <h2 class="title">Contact Form</h2>

  <form class="form" (ngSubmit)="submit()" [formGroup]="form" novalidate>
    <div class="row">
      <label class="field">
        <input type="text" formControlName="name" placeholder="nome" required/>
      </label>
      @if (form.controls.name.touched && form.controls.name.invalid) {
        <p class="feedback error">Inserisci un nome valido (min 2).</p>
      }
      <label class="field">
        <input type="text" formControlName="surname" placeholder="cognome" required/>
      </label>
      @if (form.controls.surname.touched && form.controls.surname.invalid) {
        <p class="feedback error">Inserisci un cognome valido (min 2).</p>
      }
      <label class="field">
        <input type="email" formControlName="email" placeholder="Email" required/>
      </label>
      @if (form.controls.email.touched && form.controls.email.invalid) {
        <p class="feedback error">Inserisci una email valida.</p>
      }
    </div>

    <label class="field field--textarea">
      <textarea rows="6" formControlName="message" placeholder="Il tuo messaggio..." required></textarea>
    </label>
    @if (form.controls.message.touched && form.controls.message.invalid) {
      <p class="feedback error">Minimo 10 caratteri.</p>
    }
    <!-- Consenso privacy -->
    <label class="field consent">
      <input type="checkbox" formControlName="consent" />
      <span>Acconsento al trattamento dei dati per essere ricontattato.</span>
    </label>
    @if (form.controls.consent.touched && form.controls.consent.invalid) {
      <p class="feedback error">Devi acconsentire per inviare.</p>
    }
    <!-- Honeypot (nascosto) -->
    <input 
      type="text"
      formControlName="website"
      tabindex="-1"
      autocomplete="off"
      aria-hidden="true"
      style="position:absolute; left:-9999px; opacity:0; height:0; width:0;"
    >

    <div class="actions">
      <button type="submit" class="btn" [disabled]="sending">
        <svg viewBox="0 0 24 24" aria-hidden="true" class="icon">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
        </svg>
        @if (!sending) {
          <span>Invia</span>
        } @else if (sending) {
          <span>Invio...</span>
        }
      </button>
    </div>
    @if (sent) {
      <p class="feedback success">Messaggio inviato con successo</p>
    }
    @if (error) {
      <p class="feedback error">{{ error }}</p>
    }
  </form>
</section>