<article class="tli" 
         [class.tli--editable]="canEdit()" 
         [class.tli--dragging]="isDragging()"
         [attr.draggable]="canEdit() ? 'true' : 'false'"
         (mousedown)="onMouseDown($event)"
         (dragstart)="onDragStart($event)"
         (dragend)="onDragEndNative()"
         (click)="onClick($event)">
  <!-- Icona toggle sulla linea sinistra -->
  <button 
    class="tli__toggle" 
    [class.expanded]="isExpanded()"
    (click)="toggleDescription(); $event.stopPropagation()"
    (mouseenter)="onMouseEnter()"
    type="button"
    [attr.aria-label]="isExpanded() ? 'Nascondi descrizione' : 'Mostra descrizione'"
    [attr.aria-expanded]="isExpanded()">
    <svg class="tli__toggle-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </button>
  
  <!-- Pulsante delete nell'angolo in alto a destra -->
  @if (canEdit()) {
    <button type="button" 
            class="tli__delete-btn" 
            (click)="onDeleteClick(); $event.stopPropagation()"
            title="Elimina"
            aria-label="Elimina elemento">Ã—</button>
  }
  
  <div class="tli__content">
    <!-- Wrapper per titolo e date con flex column -->
    <div class="tli__header">
      <h4 class="tli__title" [class.tli__title--editable]="canEdit()" (mouseenter)="onMouseEnter()" role="heading" aria-level="4">
        {{ displayedTitle() }}
      </h4>
      <div class="tli__years">{{ displayedYears() }}</div>
    </div>
    
    <!-- Descrizione mostrata solo se espansa -->
    @if (isExpanded()) {
      <p class="tli__desc" [class.typing]="isTyping()" (mouseenter)="onMouseEnter()" [innerHTML]="processedDescription()"></p>
    }
  </div>
</article>