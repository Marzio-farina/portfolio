<!-- Sistema di notifiche multiple -->
<app-notification 
  [notifications]="notifications()"
  [showMultiple]="showMultipleNotifications()"
  [mostSevereNotification]="getMostSevereNotification()">
</app-notification>

<h2 class="article-title">
  {{ title() }}
</h2>

@if (loading()) {
  <div class="certificates">
    @for (i of [0,1,2,3,4,5]; track i) {
      <div class="attestato-card skeleton-card">
        <div class="skeleton cover" style="height:160px;"></div>
        <div class="meta" style="gap:8px; margin-top:12px;">
          <div class="skeleton h-4 w-1/2"></div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-4 w-3/4"></div>
        </div>
      </div>
    }
  </div>
}

@if (!loading() && errorMsg()) {
  <div class="state error">
    {{ errorMsg() }}
  </div>
}

@if (!loading() && !errorMsg() && attestati().length === 0) {
  @if (showEmptyAddCard()) {
    <div class="certificates">
      <div class="attestato-card skeleton-card add-card" (click)="goToAddAttestato()" role="button" tabindex="0" aria-label="Aggiungi attestato">
        <div class="add-card-circle" aria-hidden="true">
          <svg class="add-card-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </div>
        <div class="add-card-hint">Aggiungi un attestato</div>
      </div>
    </div>
  } @else {
    <div class="state empty" aria-live="polite">Nessun attestato caricato</div>
  }
}

<div class="certificates">
  @if (!loading() && !errorMsg()) {
    @if (showEmptyAddCard()) {
      <div class="attestato-card skeleton-card add-card" (click)="goToAddAttestato()" role="button" tabindex="0" aria-label="Aggiungi attestato">
        <div class="add-card-circle" aria-hidden="true">
          <svg class="add-card-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </div>
        <div class="add-card-hint">Aggiungi un attestato</div>
      </div>
    }
    @for (a of attestati(); track a.id; let i = $index) {
      <app-attestati-card [attestato]="a" [priority]="i < 3" (deleted)="onCardDeleted($event)"/>
    }
  }
</div>